<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Nuxt 3: CASL Authorization | Alim Özdemir</title>
    <meta name="description" content="Implement authorization in Nuxt 3 using the CASL library. This guide covers configuration, Nuxt plugin setup, and usage examples to create a developer-friendly, robust, and extendable authorization system. Perfect for enhancing security and control in your Nuxt applications.">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/assets/style.-ZQ2zhvB.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.Dat-I3Zf.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.Dm_onezB.js">
    <link rel="modulepreload" href="/assets/chunks/framework.Ao2Tp7LI.js">
    <link rel="modulepreload" href="/assets/posts_nuxt-3-casl-authorization.md.m3_bd1wq.lean.js">
    <script src="https://www.googletagmanager.com/gtag/js?id=G-N7367JX5TN" async></script>
    <script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-N7367JX5TN");</script>
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
    <meta property="og:title" content="Nuxt 3: CASL Authorization | Alim Özdemir">
    <meta property="og:description" content="Implement authorization in Nuxt 3 using the CASL library. This guide covers configuration, Nuxt plugin setup, and usage examples to create a developer-friendly, robust, and extendable authorization system. Perfect for enhancing security and control in your Nuxt applications.">
    <meta property="og:url" content="https://www.alimozdemir.com/posts/nuxt-3-casl-authorization">
    <meta property="og:image" content="/img/nuxt-casl/nuxt-casl-hero-image-dorian-mongel-unsplash.jpg">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Nuxt 3: CASL Authorization | Alim Özdemir">
    <meta name="twitter:description" content="Implement authorization in Nuxt 3 using the CASL library. This guide covers configuration, Nuxt plugin setup, and usage examples to create a developer-friendly, robust, and extendable authorization system. Perfect for enhancing security and control in your Nuxt applications.">
    <meta name="twitter:url" content="https://www.alimozdemir.com/posts/nuxt-3-casl-authorization">
    <meta name="twitter:image" content="/img/nuxt-casl/nuxt-casl-hero-image-dorian-mongel-unsplash.jpg">
    <meta name="twitter:site" content="@almozdmr">
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-59c4430d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-ecd1bc0b></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-ecd1bc0b> Skip to content </a><!--]--><!----><header class="VPNav" data-v-59c4430d data-v-930260ff><div class="VPNavBar" data-v-930260ff data-v-29871249><div class="wrapper" data-v-29871249><div class="container" data-v-29871249><div class="title" data-v-29871249><div class="VPNavBarTitle" data-v-29871249 data-v-f2a17b43><a class="title" href="/" data-v-f2a17b43><!--[--><!--]--><!----><span data-v-f2a17b43>Alim Özdemir</span><!--[--><!--[--><!--[--><!--[--><!--[--><!----><img id="avatar" class="w-10" alt="Profile Photo" src="/avatar/avatar.png"><span class="name-title pl-4">Alim Özdemir</span><span class="post-title pl-4 hidden">Nuxt 3: CASL Authorization</span><!--]--><!--]--><!--]--><!--]--><!--]--></a></div></div><div class="content" data-v-29871249><div class="content-body" data-v-29871249><!--[--><!--]--><div class="VPNavBarSearch search" data-v-29871249><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-29871249 data-v-17d0a7e7><span id="main-nav-aria-label" class="visually-hidden" data-v-17d0a7e7> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-17d0a7e7 data-v-24c50f4c><!--[--><span data-v-24c50f4c>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about" tabindex="0" data-v-17d0a7e7 data-v-24c50f4c><!--[--><span data-v-24c50f4c>About</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-29871249 data-v-86871e5f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-86871e5f data-v-76c55e31 data-v-ce98919f><span class="check" data-v-ce98919f><span class="icon" data-v-ce98919f><!--[--><span class="vpi-sun sun" data-v-76c55e31></span><span class="vpi-moon moon" data-v-76c55e31></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-29871249 data-v-2b070e2c data-v-4ffd68fd><!--[--><a class="VPSocialLink no-icon" href="https://www.github.com/alimozdemir" aria-label="github" target="_blank" rel="noopener" data-v-4ffd68fd data-v-7020546b><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://www.linkedin.com/in/almozdmr/" aria-label="linkedin" target="_blank" rel="noopener" data-v-4ffd68fd data-v-7020546b><span class="vpi-social-linkedin"></span></a><a class="VPSocialLink no-icon" href="https://www.twitter.com/almozdmr" aria-label="twitter" target="_blank" rel="noopener" data-v-4ffd68fd data-v-7020546b><span class="vpi-social-twitter"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-29871249 data-v-681aea7d data-v-3246d379><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-3246d379><span class="vpi-more-horizontal icon" data-v-3246d379></span></button><div class="menu" data-v-3246d379><div class="VPMenu" data-v-3246d379 data-v-1f92d73c><!----><!--[--><!--[--><!----><div class="group" data-v-681aea7d><div class="item appearance" data-v-681aea7d><p class="label" data-v-681aea7d>Appearance</p><div class="appearance-action" data-v-681aea7d><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-681aea7d data-v-76c55e31 data-v-ce98919f><span class="check" data-v-ce98919f><span class="icon" data-v-ce98919f><!--[--><span class="vpi-sun sun" data-v-76c55e31></span><span class="vpi-moon moon" data-v-76c55e31></span><!--]--></span></span></button></div></div></div><div class="group" data-v-681aea7d><div class="item social-links" data-v-681aea7d><div class="VPSocialLinks social-links-list" data-v-681aea7d data-v-4ffd68fd><!--[--><a class="VPSocialLink no-icon" href="https://www.github.com/alimozdemir" aria-label="github" target="_blank" rel="noopener" data-v-4ffd68fd data-v-7020546b><span class="vpi-social-github"></span></a><a class="VPSocialLink no-icon" href="https://www.linkedin.com/in/almozdmr/" aria-label="linkedin" target="_blank" rel="noopener" data-v-4ffd68fd data-v-7020546b><span class="vpi-social-linkedin"></span></a><a class="VPSocialLink no-icon" href="https://www.twitter.com/almozdmr" aria-label="twitter" target="_blank" rel="noopener" data-v-4ffd68fd data-v-7020546b><span class="vpi-social-twitter"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-29871249 data-v-cd66bde9><span class="container" data-v-cd66bde9><span class="top" data-v-cd66bde9></span><span class="middle" data-v-cd66bde9></span><span class="bottom" data-v-cd66bde9></span></span></button></div></div></div></div><div class="divider" data-v-29871249><div class="divider-line" data-v-29871249></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-59c4430d data-v-10c35203><div class="container" data-v-10c35203><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-10c35203 data-v-8f23d1a3><button data-v-8f23d1a3>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-59c4430d data-v-6e3945fc><div class="VPDoc has-aside" data-v-6e3945fc data-v-07acbee8><!--[--><!--[--><!--[--><div class="info-box flex flex-row-reverse items-center justify-between mb-4 xl:flex-col xl:items-start xl:pb-4 xl:hidden" data-v-4e7dc19b><div class="py-4 flex gap-x-2" data-v-4e7dc19b><!--[--><span class="text-sm rounded border p-2" data-v-4e7dc19b>Nuxt</span><!--]--></div><div data-v-4e7dc19b><span data-v-4e7dc19b>December 1, 2024</span></div></div><!--]--><!--]--><!--]--><div class="container" data-v-07acbee8><div class="aside" data-v-07acbee8><div class="aside-curtain" data-v-07acbee8></div><div class="aside-container" data-v-07acbee8><div class="aside-content" data-v-07acbee8><div class="VPDocAside" data-v-07acbee8 data-v-a8674dc6><!--[--><!--[--><!--[--><!--[--><div class="info-box flex flex-row-reverse items-center justify-between mb-4 xl:flex-col xl:items-start xl:pb-4 hidden xl:flex" data-v-4e7dc19b><div class="py-4 flex gap-x-2" data-v-4e7dc19b><!--[--><span class="text-sm rounded border p-2" data-v-4e7dc19b>Nuxt</span><!--]--></div><div data-v-4e7dc19b><span data-v-4e7dc19b>December 1, 2024</span></div></div><!--]--><!--]--><!--]--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-a8674dc6 data-v-61e3a742><div class="content" data-v-61e3a742><div class="outline-marker" data-v-61e3a742></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-61e3a742>On this page</div><ul class="VPDocOutlineItem root" data-v-61e3a742 data-v-dcb41878><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-a8674dc6></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-07acbee8><div class="content-container" data-v-07acbee8><!--[--><!--]--><main class="main" data-v-07acbee8><div articleperpage="5" class="vp-doc _posts_nuxt-3-casl-authorization" data-v-07acbee8><div><h1 id="nuxt-3-casl-authorization" tabindex="-1">Nuxt 3: CASL Authorization <a class="header-anchor" href="#nuxt-3-casl-authorization" aria-label="Permalink to &quot;Nuxt 3: CASL Authorization&quot;">​</a></h1><blockquote><p>It&#39;s been a very long time since I wrote a blog post due to other priorities. It feels good to be back.</p></blockquote><img src="/img/nuxt-casl/nuxt-casl-hero-image-dorian-mongel-unsplash.jpg" class="hero-image" alt="Photo by Jeff DeWitt on Unsplash"><h2 id="introduction" tabindex="-1">Introduction <a class="header-anchor" href="#introduction" aria-label="Permalink to &quot;Introduction&quot;">​</a></h2><p>Nuxt is a popular web framework that covers a lot of features. However, from time to time, we need additional plugins, modules, or libraries. CASL is one such library. It is an agnostic authorization library for Javascript/Typescript. I have been using CASL for more than two years across several projects. In this blog post, I will show you how to use CASL in a Nuxt project.</p><p>By the end of this blog, we aim to achieve a developer-friendly, robust, and extendable authorization system.</p><h2 id="installation" tabindex="-1">Installation <a class="header-anchor" href="#installation" aria-label="Permalink to &quot;Installation&quot;">​</a></h2><p>I assume that you will apply these changes to an existing project, so I will explain them in that context.</p><p>You need to install the following packages in your project:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-bi-Oj" id="tab-vKO86KF" checked><label data-title="pnpm" for="tab-vKO86KF">pnpm</label><input type="radio" name="group-bi-Oj" id="tab-8TX3da-"><label data-title="npm" for="tab-8TX3da-">npm</label></div><div class="blocks"><div class="language-shell vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pnpm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @casl/ability</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @casl/vue</span></span></code></pre></div><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @casl/ability</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> @casl/vue</span></span></code></pre></div></div></div><h2 id="definitions" tabindex="-1">Definitions <a class="header-anchor" href="#definitions" aria-label="Permalink to &quot;Definitions&quot;">​</a></h2><p>First, we need to understand how CASL works. It allows us to control resource authorization in our project. For example:</p><div class="important custom-block github-alert"><p class="custom-block-title">IMPORTANT</p><p>Don&#39;t forget to check the official CASL documentation. <a href="https://casl.js.org/v6/en/package/casl-vue" target="_blank" rel="noreferrer">Documentation</a></p></div><ul><li>Can user read the articles?</li><li>Can user change the articles?</li><li>Can user <code>[action]</code> on <code>[subject]</code></li></ul><p>This is the first step in using CASL in your project. By defining these rules, you can extend all your actions across all your resources.</p><h3 id="actions" tabindex="-1">Actions <a class="header-anchor" href="#actions" aria-label="Permalink to &quot;Actions&quot;">​</a></h3><p>Assume you have a <code>types</code> folder</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-2Ic7o" id="tab-TMXUf5h" checked><label data-title="types/actions.ts" for="tab-TMXUf5h">types/actions.ts</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Actions</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Read&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Write&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Delete&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div></div></div><h3 id="subjects" tabindex="-1">Subjects <a class="header-anchor" href="#subjects" aria-label="Permalink to &quot;Subjects&quot;">​</a></h3><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-33W7p" id="tab-1x-kK-l" checked><label data-title="types/subjects.ts" for="tab-1x-kK-l">types/subjects.ts</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Subjects</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Account&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Profile&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Post&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> |</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;Comment&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div></div></div><h3 id="ability" tabindex="-1">Ability <a class="header-anchor" href="#ability" aria-label="Permalink to &quot;Ability&quot;">​</a></h3><p>Now we can define our CASL interfaces</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-hcv9P" id="tab-xvJtFaM" checked><label data-title="types/ability.ts" for="tab-xvJtFaM">types/ability.ts</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> AbilityClass, PureAbility, </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> SubjectRawRule } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@casl/ability&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Actions } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./actions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Subjects } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./subjects&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AppAbility</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PureAbility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;[</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Actions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Subjects</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]&gt;;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> AppAbility</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> PureAbility </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AbilityClass</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AppAbility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Rule</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> SubjectRawRule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Actions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Subjects</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">unknown</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Permission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Actions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Subjects</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">];</span></span></code></pre></div></div></div><p>With this, we will have strongly-typed functions in our app.</p><h2 id="nuxt-plugin" tabindex="-1">Nuxt Plugin <a class="header-anchor" href="#nuxt-plugin" aria-label="Permalink to &quot;Nuxt Plugin&quot;">​</a></h2><p>So far, we&#39;ve configured CASL. Now, let&#39;s focus on Nuxt integration.</p><p>To use CASL, we need the <code>@casl/vue</code> package.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-wQ4Jo" id="tab-qyWAna-" checked><label data-title="plugins/permission.ts" for="tab-qyWAna-">plugins/permission.ts</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { PureAbility } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@casl/ability&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { abilitiesPlugin } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@casl/vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Rule } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;~/types/permissions/ability&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineNuxtPlugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">async</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;"> nuxtApp</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ability</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PureAbility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Define the rules here</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // You can watch your user token (JWT) and update the rules accordingly</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rules</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Rule</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* Get your roles and convert them into rule object accordingly */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ action: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Read&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, subject: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Account&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ action: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Write&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, subject: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Account&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    rules.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">push</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ action: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Read&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, subject: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Post&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    /* Get your roles and convert them into rule object accordingly */</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // where the CASL understands your user&#39;s abilities</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ability.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">update</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(rules)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // install casl for vue</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    nuxtApp.vueApp.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">use</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(abilitiesPlugin, ability, {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        useGlobalProperties: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></div></div><p>In the plugin, you configure your user&#39;s abilities. In most cases, I parse the user&#39;s JWT token to get all roles and configure abilities accordingly. This part depends on your authentication approach.</p><h2 id="composable" tabindex="-1">Composable <a class="header-anchor" href="#composable" aria-label="Permalink to &quot;Composable&quot;">​</a></h2><p>Next, we create a composable to make using CASL easier throughout the app:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-kbuGv" id="tab-pqc9b4Q" checked><label data-title="composables/useAppAbilitiy.ts" for="tab-pqc9b4Q">composables/useAppAbilitiy.ts</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { useAbility } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@casl/vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { AppAbility } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;~~/types/permissions/ability&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useAppAbility</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useAbility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">AppAbility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;();</span></span></code></pre></div></div></div><p>This will allow us to check user authorizations in nuxt.</p><h2 id="can-global-property" tabindex="-1"><code>$can</code> global property <a class="header-anchor" href="#can-global-property" aria-label="Permalink to &quot;`$can` global property&quot;">​</a></h2><p>At this point, we are ready to test CASL in an action. If you check the plugin, you&#39;ll see that the user has three permissions defined. For instance, the user has Post Read permission, so the following button will be rendered:</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$can(&#39;Read&#39;, &#39;Post&#39;)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;View post&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>This button, however, will not render because the user does not have <code>Write</code> access to Post:</p><div class="language-html vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">html</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> v-if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;$can(&#39;Write&#39;, &#39;Post&#39;)&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;Edit post&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">button</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;</span></span></code></pre></div><p>You might notice that there is no IntelliSense for the <code>$can</code> function. To enable IntelliSense, you can extend your Typescript declarations. Here&#39;s how:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-IAn4N" id="tab-Nu60fVH" checked><label data-title="index.d.ts" for="tab-Nu60fVH">index.d.ts</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { AppAbility } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./types/permissions/ability&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">declare</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> module</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ComponentCustomProperties</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        $ability</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AppAbility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        $can</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Parameters</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">this</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;$ability&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">][</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;can&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]&gt;)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> boolean</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { }</span></span></code></pre></div></div></div><p>Now, intellisense will also work for <code>$can</code>:</p><img src="/img/nuxt-casl/intellisense.png" class="center-image" alt="Nuxt CASL $can intellisense"><p>For advanced use cases, you can access more CASL functions through the <code>$ability</code> global variable as well</p><img src="/img/nuxt-casl/ability-global.png" class="center-image" alt="Nuxt CASL $ability intellisense"><h2 id="middleware-and-page-protection" tabindex="-1">Middleware and page protection <a class="header-anchor" href="#middleware-and-page-protection" aria-label="Permalink to &quot;Middleware and page protection&quot;">​</a></h2><p>So far, so good. We can extend this logic to Nuxt pages, providing a structured way to handle authorization.</p><p>In Nuxt, we can use <code>definePageMeta</code> to define page properties. We can add a permission property there. Although there’s a known issue with typescript declarations for <code>definePageMeta</code>, you can still use it effectively.</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-9hy41" id="tab-PWN6JNG" checked><label data-title="index.d.ts" for="tab-PWN6JNG">index.d.ts</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Permission } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;./types/permissions/ability&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Known issue: https://github.com/nuxt/nuxt/discussions/19949</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">declare</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> module</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;#app&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    interface</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> PageMeta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">        permission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">?:</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Permission</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { }</span></span></code></pre></div></div></div><p>Here&#39;s how to extend PageMeta with a <code>permission</code> property:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-9DjPs" id="tab-4Oq-mMF" checked><label data-title="auth.vue" for="tab-4Oq-mMF">auth.vue</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">script setup lang</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ts&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">definePageMeta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;auth&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    permission: [</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Read&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;Comment&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;/</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">script</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div></div></div><p>Now, create a middleware to check permissions based on abilities:</p><div class="vp-code-group vp-adaptive-theme"><div class="tabs"><input type="radio" name="group-CSsmc" id="tab-vHaswXj" checked><label data-title="middleware/guard.global.ts" for="tab-vHaswXj">middleware/guard.global.ts</label></div><div class="blocks"><div class="language-ts vp-adaptive-theme active"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Actions } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;~~/types/permissions/actions&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> type</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { Subjects } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;~~/types/permissions/subjects&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> defineNuxtRouteMiddleware</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">((</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">to</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ability</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> useAppAbility</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> checkPermission</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> computed</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">to.meta.permission </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Array.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isArray</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(to.meta.permission) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">to.meta.permission[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> !</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">to.meta.permission[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> action</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> to.meta.permission[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Actions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> subject</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> to.meta.permission[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Subjects</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ability.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">can</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(action, subject);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    });</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ((to.path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> from.path </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">||</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">meta</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.server) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&amp;&amp;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> to.meta.permission) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (checkPermission.value) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> abortNavigation</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            statusCode: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">403</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            fatal: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            message: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;You are not allowed to access this page&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div></div></div><p>Now, when trying to access the <code>/auth</code> page, unauthorized users will see the following screen. You can customize it as needed:</p><img src="/img/nuxt-casl/403.png" class="center-image" alt="Nuxt CASL 403 page"><h2 id="source-code" tabindex="-1">Source code <a class="header-anchor" href="#source-code" aria-label="Permalink to &quot;Source code&quot;">​</a></h2><p>You can check out a complete example in my GitHub repository. <a href="https://github.com/alimozdemir/nuxt-casl-sample" target="_blank" rel="noreferrer">nuxt-casl-sample</a></p></div></div></main><footer class="VPDocFooter" data-v-07acbee8 data-v-6b8b697d><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--[--><!--[--><div class="container flex items-center justify-between mx-auto max-w-3xl w-full pb-8"><span class="invisible">No Prev</span><a class="VPButton big alt" href="/posts/aspnet-core-concatenating-json-endpoints" data-v-2bf5222a>Next</a></div><!--]--><!--]--><!--]--></div></div><footer class="VPFooter" data-v-59c4430d data-v-929dc9cf><div class="container" data-v-929dc9cf><!----><p class="copyright" data-v-929dc9cf>Copyright © 2019-present Alim Özdemir</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about.md\":\"DtwXcIKv\",\"index.md\":\"D-Y4UAdA\",\"page_1.md\":\"C9ooMqAK\",\"page_2.md\":\"B3xveMde\",\"page_3.md\":\"Dtry9oOv\",\"posts_asp-net-core-a-powerful-api-design-with-odata-ef-and-sqlkata.md\":\"CUKWBiwe\",\"posts_aspnet-core-concatenating-json-endpoints.md\":\"DY9misjc\",\"posts_aspnet-core-jwt-and-refresh-token-with-httponly-cookies.md\":\"BpEQeSYu\",\"posts_better-di-service-registration-with-assembly-scan.md\":\"L9cgB9Ew\",\"posts_deget-ddown-a-downloader-cli-api-for-dotnet.md\":\"yonjmOjl\",\"posts_deployment-of-signalr-with-nginx.md\":\"D9hDXOht\",\"posts_design-pattern-serisi-1-singleton.md\":\"DC00e0i1\",\"posts_design-pattern-serisi-2-object-pool.md\":\"CLQDFLw8\",\"posts_design-pattern-serisi-3-pipeline.md\":\"VP8SPtut\",\"posts_fabric-js-history-operations-undo-redo-and-useful-tips.md\":\"DnJ_saBK\",\"posts_hangfire-docker-with-multiple-servers.md\":\"CYXE1MfW\",\"posts_ml-net-kullanarak-coklu-dil-siniflandirma.md\":\"D2Qd73ZX\",\"posts_nuxt-3-casl-authorization.md\":\"m3_bd1wq\",\"posts_signalr-core-heartbeat-and-redis.md\":\"C3r4Zl7j\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"Alim Özdemir\",\"description\":\"Alim Özdemir Personal Website\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://www.github.com/alimozdemir\"},{\"icon\":\"linkedin\",\"link\":\"https://www.linkedin.com/in/almozdmr/\"},{\"icon\":\"twitter\",\"link\":\"https://www.twitter.com/almozdmr\"}],\"footer\":{\"copyright\":\"Copyright © 2019-present Alim Özdemir\"},\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"About\",\"link\":\"/about\"}],\"search\":{\"provider\":\"local\"}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":true,\"contentProps\":{\"articlePerPage\":5}}");</script>
    
  </body>
</html>